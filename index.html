<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Cek Tagihan PLN - Online</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
</head>
<body>
    <div class="container" style="margin-top: 50px;">
    <div class="row">
      <div class="col-sm-5">
        <div class="panel panel-primary">
          <div class="panel-heading">
            <h2 class="panel-title">Cek Tagihan PLN</h2>
          </div>
          <div class="panel-body">
            <form class="form-horizontal" method="get" action="http://ibacor.com/api/tagihan-pln">
              <div class="form-group">
                <label for="idplg" class="col-sm-2 control-label">ID Plg.</label>
                <div class="col-sm-10">
                  <input type="number" class="form-control" id="idplg" name="idp" placeholder="Masukkan ID Pelanggan..." required>
                </div>
              </div>
              <div class="form-group">
                <label for="bln" class="col-sm-2 control-label">Bulan</label>
                <div class="col-sm-10">
                    <select class="form-control" name="bln">
                      <option value="01">Januari</option>            
                      <option value="02">Februari</option>            
                      <option value="03">Maret</option>            
                      <option value="04">April</option>            
                      <option value="05">Mei</option>            
                      <option value="06">Juni</option>            
                      <option value="07">Juli</option>            
                      <option value="08">Agustus</option>            
                      <option value="09">September</option>            
                      <option value="10">Oktober</option>            
                      <option value="11">Nopember</option>            
                      <option value="12">Desember</option>            
                    </select>
                </div>
              </div>
              <div class="form-group">
                <label for="bln" class="col-sm-2 control-label">Tahun</label>
                <div class="col-sm-10">                    
                    <select class="form-control" name="thn">
                    </select>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                  <button type="submit" class="btn btn-primary">Cek sekarang!</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="col-sm-7">
        <div class="panel panel-primary">
          <div class="panel-heading" role="tab" id="headingOne">
            <h4 class="panel-title">
              <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                Response
              </a>
            </h4>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
            <div class="panel-body">
            <strong>Tidak ada data</strong>
            <div class="progress">
              <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                <span class="sr-only">100% Complete</span>
                Memproses, mohon tunggu...
              </div>
            </div>
              <table class="table tbl-bordered tbl-condensed">
                <tr>
                  <th>ID Pelanggan</th>
                  <td id="tbl_idplg"></td>
                </tr>
                <tr>
                  <th>Nama</th>
                  <td id="tbl_nama"></td>
                </tr>
                <tr>
                  <th>Alamat</th>
                  <td id="tbl_alamat"></td>
                </tr>
                <tr>
                  <th>Tarif / Daya</th>
                  <td id="tbl_trf"></td>
                </tr>
                <tr>
                  <th>Pemakaian kwh</th>
                  <td id="tbl_kwh"></td>
                </tr>
                <tr>
                  <th>Bulan / Tahun</th>
                  <td id="tbl_blnthn"></td>
                </tr>
                <tr>
                  <th>Tagihan</th>
                  <td id="tbl_rp"></td>
                </tr>
                <tr>
                  <th>Terbilang</th>
                  <td id="tbl_bilang"></td>
                </tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>


  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/numeral.js/1.5.3/numeral.min.js"></script>
  <script type="text/javascript">
    $(function () {
      var dn = new Date();
      var yn = dn.getFullYear();
      var yb = yn-1;

      var options = "<option value="+yb+">"+yb+"</option>";
          options = options + "<option value="+yn+">"+yn+"</option>";

      $('select[name=thn]').append(options);
      $('select[name=thn]').val(yn);
      $('.panel-body').eq(1).hide();

      $('.form-horizontal').submit(function(e){
        $('.tbl-bordered').hide();
        $('strong').hide();
        $('.panel-body').eq(1).show();
        $('.progress').show();
        $('#collapseOne').collapse('show');

        var idp = $('input[name=idp]').val();
        var bln = $('select[name=bln]').val();
        var thn = $('select[name=thn]').val();
        var url = 'http://ibacor.com/api/tagihan-pln';

        $.get(url, {idp: idp, bln: bln, thn: thn}, function(resp){
          console.log(resp);
          $('.progress').hide();
          $('.tbl-bordered').show();
          if (resp.status == 'success') {
            var rp = numeral(resp.data.tagihan).format('0,0');
                rp = rp.replace(/\,/g, '.');

            $('#tbl_idplg').html(resp.data.idpel);
            $('#tbl_nama').html(resp.data.nama);
            $('#tbl_alamat').html(resp.data.alamat);
            $('#tbl_trf').html(resp.data.tarif+'/'+resp.data.daya);
            $('#tbl_kwh').html(resp.data.pemkwh);
            $('#tbl_blnthn').html(resp.data.namathblrek);
            $('#tbl_rp').html('Rp '+rp);
            $('#tbl_bilang').html(resp.data.terbilang);
          } else {
            $('.tbl-bordered').hide();
            $('strong').show();            
          }
        }, 'json');
        e.preventDefault();
      });
    });
  </script>
</body>
</html>